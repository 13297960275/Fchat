(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["fonlineconsultation"]=t(require("vue")):e["fonlineconsultation"]=t(e["Vue"])})("undefined"!==typeof self?self:this,(function(e){return function(e){function t(t){for(var n,i,s=t[0],r=t[1],a=0,c=[];a<s.length;a++)i=s[a],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&c.push(o[i][0]),o[i]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);l&&l(t);while(c.length)c.shift()()}var n={},o={0:0};function i(e){return s.p+"fonlineconsultation.umd.min."+({}[e]||e)+".js"}function s(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,i){n=o[e]=[t,i]}));t.push(n[2]=r);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=i(e);var l=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(d);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+i+": "+s+")",l.name="ChunkLoadError",l.type=i,l.request=s,n[1](l)}o[e]=void 0}};var d=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var r=("undefined"!==typeof self?self:this)["webpackJsonpfonlineconsultation"]=("undefined"!==typeof self?self:this)["webpackJsonpfonlineconsultation"]||[],a=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var l=a;return s(s.s="fb15")}({2308:function(e,t,n){e.exports=n.p+"img/oval.be00fc4a.svg"},8715:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH4AAADDCAYAAABEd6UjAAAAAXNSR0IArs4c6QAACvZJREFUeAHtXFvMHVUV5lio/BVjQGkkpCamRjBRIBJtrUT+SgxyK0kJjSLlRR5I4MUQH/piyiM0JMQX5EEeRMSgNTFKwRcpWBouieIlUUAloeEqARUQSqGH78Pd03NZ5/xnZu+Z2fusbyUre2bNvnyX0zkzZ+bvMccopIAUkAJSQApIASkgBaSAFJACUkAKSAEpIAWkgBSQAlJACkgBKSAFpIAUkAJSQApIASkgBaSAFJACUkAKSAEpIAWkgBSQAlJACkgBKeBMgZ4zvjPp9vv9U9BhPfJE5AnID4dcQvsm8rWQr6N9FfmPXq/3PNriwqXxMPg4OPUF5LnIzyE/HZJGVw1+GJ4M+We0DyAfwwfiENpsw43xMPszcOFS5DLyHOSHkE3FG5h4H3Iv8pf4EPwVbVax0MbD7I9D7W8ir0R+vkPlf4+1f4y8Cx+CFzrEsdhLw/Bzkfcg30HmFMRDXPyKUaRQAGL2kJcg9yNLCOIk3oU+66bwduocEO885J+QJQZxnzeVnA5MKgDB1iHvLtFtAzN5rJtkqcpAAQi0CrkD+QZykYJ8yGvVgGxDG8V9v0CUT0CLnyC/3JAmOUz7EEBcgTuAZ5oC84GmJm5iXpi+FfM+jlxk0ykd+T0e+HI/eRRhPE99yO+D/W4kf071EOS5m7zJPzXh7E/1IL0GpH+KvCQ1+YLm+xWwfgOn/v+lwpy18TD9YyD6a+SGVIQLnucRYL8Y5r+cgkO2xsN03tr8FvmpFEQXZI6/g8dXYf6BWD5ZGg/T14LY75B8atZ28DErn7Y9i+TjVz594yNZPprl0zs+rj0VSWx8jNt2PIEFvwLzX4pZODvjYfpHQGgv8qwYYnOOHX6K9gDG/AWC0ui5Alj5Qfgskr+9LyObfuqHJd4P3tksA+t/wn7ZDYRcg9yHbDIOYvJfIC9DHp9SMc4X5uX8XKfJoE688C0/QOTOBpX6F+b+HvKjbSjFdcJ6XLepuLMNLo2uAWWubUidVzDvd5Cd/OvgumF94mgirm3UmCYnhxobkalPje9iztuQvCXsPIgj4CGulEHdNnZOsCoAgD4JeSClEpjraeSXqmJpoz9xBXxokgX1O6kN/MnWAODbk9H//0R3oeGdQbZBfEjiTBm3Z0t4HBhYb07I/DDm+u74GjnvEy+SuFPF5pz5vo8NTHnr82Qixm9hnm3ZkzYAEjeS+FME9Ux6i2pAjisB4A0pmGIOiva1ODTdjib+wANNdNzQLZsZq4Mar3Bfi6bY7x/CHFtmLFXMIfJAkk9sUNcs7mQmxAewm2LZhfHbJyYvuABOVyXS5absZACxtcgU78rdkh25BICgzS0JzKe+fNCVTwDQzQmIPYg5js2HVTok5IUkv9i4OR2qyJnAZAn570hG/8X4hX4NmfyQ5BkT1JmPks1o+527y4Ei9seVHSleRDDVyKQY+O2IhEOdqXf3gU9g7CnsIcyR3TsETShLnkjyjYkHm8BWaU6gPy2GQRi7qdKihXcG500JNDvNkqHNU/23LAAVantwCtxfoX/xXQPfPZFErogcHzccn9zHIj+9Z8chKHM0NDs7UrdHO2MO4CcjYx5GuPqXPm4UtIv502/qfvL4nG2d6s/HwjEXZbeNA3e2H8OfulP/kWjL+K+PrFpth2+S3l1tyML1Jv+YN2on9G/L+C9GWHEfLnL4XrvbCPzvixBgQv/Gjcf3yxoAXh8B+p6IsYs0NEaH9cGHgR6NG4+V+AcHddc5jLH3DtD63qAO1KNOUH/6MIi6hgwmmGPjjDn6TOvyFE5zL0876KkedHgqgvOID20YP/JJqwj8DxX7L3r3GD1GfGjD+FMi3OB/DKg4qkCMHiM+tGF8zGtATxzlrC0owL/irRsjPuRu/It1WS7ouBcieLVu/MTPhRXAxxCtsEwxXWP0GDE+5mfUudTC/ePb6HjcXJ0nOx2Pq9mDk2WfFWj5QTB/qyb7Q9By9ZGxbRjfP7JY1RZAG8dXFVPX/WF+Ej3b+I7vWiutbygg4w1RPJRkvAeXDY4y3hDFQ0nGe3DZ4CjjDVE8lGS8B5cNjjLeEMVDScZ7cNngKOMNUTyUZLwHlw2OMt4QxUNJxntw2eAo4w1RPJRkvAeXDY4y3hDFQ0nGe3DZ4CjjDVE8lGS8B5cNjjLeEMVDScZ7cNngKOMNUTyUZLwHlw2OMt4QxUNJxntw2eAo4w1RPJRkvAeXDY4y3hDFQ0nGe3DZ4CjjDVE8lGS8B5cNjjLeEMVDScZ7cNngKOMNUTyUZLwHlw2OMt4QxUNJxntw2eAo4w1RPJRkvAeXDY4y3hDFQ0nGe3DZ4CjjDVE8lGS8B5cNjjLeEMVDScZ7cNngKOMNUTyUZLwHlw2OMt4QxUNJxntw2eAo4w1RPJRkvAeXDY4y3hDFQ0nGe3DZ4CjjDVE8lGS8B5cNjjLeEMVDScZ7cNngKOMNUTyUZLwHlw2OMt4QxUNJxntw2eAo4w1RPJRkvAeXDY4y3hDFQ0nGe3DZ4CjjDVE8lGS8B5cNjscO1/r9/rexv2641uU28OxMvP6BXq/3w8RzFjldbxg1hD4T+/uQJwzXF2T7dfA4B8b/sWQ+8KhfFz+4D/weOdUHUbZh4nfrTp7pOPLZVrrpKbUdMZ4TQ5x70VyXcpEM5rou8MoASh4QJownLIj0AzS78oAYjWJX4BM90SJNMDjnj5PCVwmP/Qx52fixgvZ3A+vlML7292JuXFN9x081noSxyBKa+5EbuF9YPAK8m2H6m4Xhngm3FeOJAAutRfMw8pPcLySeBs6NMP2lQvDODTOV8eZ3/DCKIN6FqL06XM94mzgvXETTU2q+ovFcDCL+Dc1W5NvczziIb2vAmzHM7qHNZTxhQsy9aK7mdsZxdcCZMcQ8oM1tPOFC1DvQ7OR2hrEz4MsQWn6QZl7VT4OLC4wf4dj2acc7qN8B06/qYN3Wl0x1cVfX+NVg/BvkcuvMJxfci9L5MD73649J5DUqnRpPvABwIpr9yNO531HwonMTTC/ljiNaplTGV/qOH0YdxOZtXlf3ylyXt21uTB/WP3a7tvFcGKLzh5ItyLZ/HeN6W8L62FRUVSDKeC4G8fnTKC/02vo9nOtsD+tiU9GpAvjuuZ7fPy3E9Z0S7XjxGH0bgw5Qt8YAm2PsrY2BL2TiOTSa2qUxilhxFXLP1JXjDnDeVY2BL2TiGAmHKda6jx+eYHwbwPi+Ht/bO3P8WMQ+35Pj+3J8b8510Pi6AkC/gd+DjbqTWeOA7VTUedHHNjaexQQbgJmt+0hlfPRVveVEMOkiHIv9F8rxF8l0S+WMa/h0XoB8h5/SGsFxF2RMrxNoNXQcDGkVMFa9ZrBytY1rWgVayGLVJBzt3TpFLL9rFMKKe4vyhm9yrVdUbkaH5GBWmhBYesifz8A0fIj9GrnoXAlnCceHhaq63Qk/gFxCPrwCWB5f6gRgIYuuoN/Mw51RBKq1yH9OQcc63+hVzFBginZzlWdM2/whIDwd+coYUu53+Vy/eeKJVhjTrdJuIgj1pwHaZeTBgJrtcv3ZfI0MmtVqslAKyLcjD7PNAlAhIGo5HgZlQxF4NmQDphAgqYzXbVMhhh+BSeOPbFdt8dP3wO9GfquvCkj9KynwfKXeRzuPjJPxR4UpZYt/1FIn6o6rs5bGpFYAZ/rVyBuRzyHnCfZjf/4thEIKSAEpIAWkgBSQAlJACkgBKSAFpIAUkAJSQApIASkgBaSAFJACUkAKSAEpIAXaUeA9Wy5cKfbDn+gAAAAASUVORK5CYII="},8875:function(e,t,n){var o,i,s;(function(n,r){i=[],o=r,s="function"===typeof o?o.apply(t,i):o,void 0===s||(e.exports=s)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(g){var n,o,i,s=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,r=/@([^@]*):(\d+):(\d+)\s*$/gi,a=s.exec(g.stack)||r.exec(g.stack),c=a&&a[1]||!1,l=a&&a[2]||!1,d=document.location.href.replace(document.location.hash,""),u=document.getElementsByTagName("script");c===d&&(n=document.documentElement.outerHTML,o=new RegExp("(?:[^\\n]+?\\n){0,"+(l-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=n.replace(o,"$1").trim());for(var p=0;p<u.length;p++){if("interactive"===u[p].readyState)return u[p];if(u[p].src===c)return u[p];if(c===d&&u[p].innerHTML&&u[p].innerHTML.trim()===i)return u[p]}return null}}return e}))},"8bbf":function(t,n){t.exports=e},"8c16":function(e,t,n){e.exports=n.p+"img/voice.7e966772.png"},a9d8:function(e,t,n){e.exports=n.p+"img/left.6d512d6c.jpg"},daf2:function(e,t,n){e.exports=n.p+"img/right.53d3da8b.jpg"},fb15:function(e,t,n){"use strict";if(n.r(t),"undefined"!==typeof window){var o=window.document.currentScript,i=n("8875");o=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i});var s=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);s&&(n.p=s[1])}var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",e._b({staticClass:"fonlineconsultation-outer-div",attrs:{id:"fonlineconsultation"}},"div",e.Height,!1),[o("div",{ref:"onlineHeader",staticClass:"online-header-all",attrs:{id:"onlineHeader"}},[o("div",{staticClass:"online-header-all-left"},[e._v("功能1")]),o("div",{staticClass:"online-header-all-center"},[e._v(e._s(e.username))]),o("div",{staticClass:"online-header-all-right"},[e._v("功能2")])]),o("div",e._b({ref:"onlineContentAll",staticClass:"online-content-all"},"div",e.contentProp,!1),[e._t("popList",e._l(e.MessageArray,(function(t,n){return o("pops",{key:n,attrs:{leftSrc:e.popLeftAva,rightSrc:e.popRightAva,bg:e.popBg,size:e.popSize,content:t["content"],type:t["type"],pos:t["pos"],duration:t["duration"]||"未知"},scopedSlots:e._u([{key:"message",fn:function(){return[e._t("message",null,{Item:t})]},proxy:!0},{key:"image",fn:function(){return[e._t("image",null,{Item:t})]},proxy:!0},{key:"audio",fn:function(){return[e._t("audio",null,{Item:t})]},proxy:!0},{key:"video",fn:function(){return[e._t("video",null,{Item:t})]},proxy:!0}],null,!0)})})),{List:e.MessageArray})],2),o("div",{ref:"onlineInput",staticClass:"online-input-content",attrs:{id:"onlineInput"}},[o("div",{staticClass:"online-input-content-lefticon"},[e._t("leftIcon",[e.isVoice?e._e():o("span",{class:e.leftIcon,style:{fontSize:e.leftIconSize+"px",color:e.leftIconColor},on:{click:e.leftHandlerClick}}),e.isVoice?o("span",{class:e.leftIconChange,style:{fontSize:e.leftIconSize+"px",color:e.leftIconColor},on:{click:e.leftHandlerClick}}):e._e()])],2),o("div",{staticClass:"online-input-content-centerInput"},[e._t("centerText",[e.isVoice?e._e():o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageString,expression:"messageString"}],ref:"msgInput",attrs:{id:"msgInput",cols:"24",rows:e.controlRows},domProps:{value:e.messageString},on:{blur:function(t){return e.controlHeight("blur")},focus:function(t){return e.controlHeight("focus")},input:[function(t){t.target.composing||(e.messageString=t.target.value)},e.controlRow]}}),e.isVoice?o("div",{staticClass:"online-input-content-centerInput-voice",style:{height:0==e.isIOS?"21px":"",marginBottom:1==e.isIOS?"2px":"",marginTop:1==e.isIOS?"2px":""}},[o("button",{style:{lineHeight:1==e.isIOS?"20px":""},on:{touchstart:e.startVoice,touchmove:e.moveVoice,touchend:e.endVoice}},[e._v(e._s(e.voiceMsg))])]):e._e()])],2),o("div",{staticClass:"online-input-content-righticon"},[e._t("rightIcon",[o("span",{class:e.rightIconLeft,style:{fontSize:e.rightIconSize+"px",color:e.rightIconColor},on:{click:e.rightHandlerClick}}),o("span",{class:e.rightIconRight,style:{right:"",fontSize:e.rightIconSize+"px",color:e.rightIconColor},on:{click:e.messageHandler}})])],2)]),e._t("loading",[o("div",{staticClass:"MessageLoading",style:{display:"none",height:e.loadingHeight},attrs:{id:"messageLoading"}},[o("img",{staticClass:"MessageLoading-Img",attrs:{width:"50px",src:n("2308"),alt:""}})])]),o("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"sendImg"}}),e.startVoiceBoolean?o("div",{staticClass:"voice-pop"},["正在录音...."==e.voiceContent?o("img",{attrs:{src:n("8c16"),alt:"",width:"50px"}}):e._e(),"正在录音...."!=e.voiceContent?o("img",{attrs:{src:n("8715"),width:"50px",alt:""}}):e._e(),o("div",{staticClass:"voice-pop-contant"},[e._v(e._s(e.voiceContent))])]):e._e(),e.voiceStartLoading?o("div",{staticClass:"voice-pop"},[o("img",{attrs:{src:n("2308"),width:"50px",alt:""}}),e._m(0)]):e._e()],2)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"voice-pop-contant"},[n("br"),e._v("Loading")])}],c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"content-pops-all"},["left"===e.pos?o("div",{staticClass:"content-avatar"},[o("img",{attrs:{src:e.leftSrc,width:"40px",height:"40px",alt:""}})]):e._e(),"message"===e.type?o("div",{class:e.className},[e._t("message",[o("div",e._b({class:"content-pops-"+e.pos+"-content"},"div",e.PopProp,!1),[o("pre",{domProps:{innerHTML:e._s(e.content)}})])])],2):e._e(),"image"===e.type?o("div",{class:e.className},[e._t("image",[o("div",e._b({class:"content-pops-"+e.pos+"-content"},"div",e.PopProp,!1),[o("div",{staticStyle:{"text-align":"center"}},[e.imgLoadingComplete?e._e():o("div",{staticClass:"content-pops-all-img-loading"},[o("img",{attrs:{src:n("2308"),width:"50px",alt:""}})]),o("img",{style:{marginTop:"0px",display:1==e.imgLoadingComplete?"block":"none"},attrs:{src:e.content,alt:"loading",width:"100%"},on:{load:function(t){return e.imgLoad(e.content)}}})])])])],2):e._e(),"audio"===e.type?o("div",{class:e.className},[e._t("audio",[o("div",e._b({class:"content-pops-"+e.pos+"-content"},"div",e.PopProp,!1),[o("div",[o("div",{class:"content-pops-"+e.pos+"-content-audio",on:{click:function(t){return e.play(e.content,e.duration)}}},["right"==e.pos?o("span",[e._v(e._s("number"==typeof e.duration?e.duration+'"':e.duration)+" ")]):e._e(),o("span",{class:"left"==e.pos?"FiconFont  icon-yuyin1":"FiconFont  icon-yuyin"}),"left"==e.pos?o("span",[e._v(" "+e._s("number"==typeof e.duration?e.duration+'"':e.duration))]):e._e()])])])])],2):e._e(),"video"===e.type?o("div",{class:e.className},[e._t("video",[o("div",e._b({class:"content-pops-"+e.pos+"-content"},"div",e.PopProp,!1),[o("div",[o("video",{staticClass:"videoBox",attrs:{id:"PopsVideo",width:"100%",src:e.content,preload:"",controls:"","webkit-playsinline":"true",playsinline:"true","x-webkit-airplay":"allow","x5-video-player-type":"h5","x5-video-player-fullscreen":"true","x5-video-orientation":"portraint"}})])])])],2):e._e(),"right"===e.pos?o("div",{staticClass:"content-avatar"},[o("img",{attrs:{src:e.rightSrc,width:"40px",height:"40px",alt:""}})]):e._e()])])},l=[],d=n("8bbf"),u=n.n(d);class p{constructor(e){this.message=e,this.loadingState=!1,this.maxSize=2,this.onlyImg=!1,this.ToastDiv=null,this.voiceState=!1,this.audioObj="",this.isOpenVoice=!1}openVoice(e,t){const o=this;u.a.prototype.$RecordApp||(setTimeout((function(){o.createToast("正在加载音频插件，请稍等")}),0),Promise.all([Promise.all([n.e(1),n.e(2)]).then(n.bind(null,"9335"))]).then((function(){console.log("音频插件以挂载"),o.isOpenVoice=!0,t&&u.a.prototype.$RecordApp.RequestPermission((function(){o.createToast("音频授权成功。")}),(function(e,t){o.createToast(t?"授权出现问题":"音频出现故障，原因是："+e),o.voiceState=!0}))})),e&&(console.log(window),window.PageSet_RecordAppWxApi=e))}setConfig(e,t,n){if(n)for(var o in n)this[o]&&(this[o]=n[o]);else{if(null===this[e]&&void 0===this[e])throw Error("参数错误");this[e]=t}}loading(e,t,n=!1){let o=document.getElementById("msgInput"),i=document.getElementById(t||"messageLoading");i.style.display="block",this.loadingState=!0,o&&n&&(o.disabled=!0),setTimeout(()=>(i.style.display="none",this.loadingState=!1,o&&(o.disabled=!1),new Promise((e,t)=>{e("请求超时")})),e||5e3)}getLoading(){return this.loadingState}cancelLoading(e){let t=document.getElementById(e||"messageLoading");t.style.display="none",this.loadingState=!1;let n=document.getElementById("msgInput");n&&n.disabled&&(n.disabled=!1)}scrollMessage(){let e=document.querySelector(".online-content-all");if(e){let t=e.scrollHeight;e.scrollTo({top:t,behavior:"smooth"})}}delMessage(){let e=document.getElementById("msgInput");e.rows=1,e.value="",e.dispatchEvent(new Event("input"))}setMessageList(e,t){if(this.message.length=0,t)t.call(this,e);else{if(0==e.length)return;e.forEach(e=>this.message.push(e))}}getMessage(){return this.message}addMessage(e,t){var n={},o=/((http|https|ftp)(:\/\/)([a-z]|[0-9]|[\.]|[:])+)/gi,i=e.match(o);return i&&(e=e.replace(o,`<a href=${i[0]}>${i[0]}</a>`)),n["content"]=e,n["type"]="message",n["pos"]=t||"right",n}addImage(e){return new Promise((t,n)=>{var o={},i=document.getElementById("sendImg");i.value="",i.click(),i.onchange=i=>{var s,r=i.target.files;if(r&&0!=r.length){s=r[0];var{type:a,size:c}=s;console.log(a,s,c),c=(c/1024).toFixed(2)/1e3;var l=new FileReader;l.readAsDataURL(s),l.onload=function(i){const s=this.result;o["content"]=s,-1!=a.indexOf("image")&&(o["type"]="image",c>this.maxSize&&n("上传图片过大")),-1==a.indexOf("video")||this.onlyImg||(o["type"]="video"),-1==a.indexOf("image")&&-1==a.indexOf("video")&&n("请传入正确类型"),o["pos"]=e||"right",t(o)}}}})}sendMessage(e){this.message.push(e),setTimeout(()=>{this.scrollMessage(),setTimeout(()=>{"audio"!=e["type"]&&"video"!=e["type"]&&"image"!=e["type"]&&this.delMessage()},0)},0)}sendVoice(e,t,n){var o={};return o["content"]=e,o["type"]="audio",o["pos"]=n||"right",o["duration"]=t,o}playVoice(e,t){if(""==this.audioObj){var n=document.createElement("audio");n.src=e,document.body.appendChild(n),this.audioObj=n}else this.audioObj.src=e;this.audioObj.play(),this.createToast("正在播放音频 ...",1e3*t)}startVoice(){return new Promise((function(e,t){u.a.prototype.$RecordApp.Start({type:"mp3",sampleRate:16e3,bitRate:16,onProcess:function(e,t,n,o,i,s){console.log(e,t,n,o,i,s)}},(function(){e(),console.log("开始录音 ....")}),(function(e){t("开始录音失败："+e),console.log("开始录音失败："+e)}))}))}pauseVoice(){let e=this;return new Promise((function(t,n){u.a.prototype.$RecordApp.Stop((function(n,o){console.log(n,(window.URL||window.webkitURL).createObjectURL(n),"时长:"+o+"ms");let i=(window.URL||window.webkitURL).createObjectURL(n);o&&(o=Math.ceil(o/1e3));var s=e.sendVoice(i,o);t(s)}),(function(e){console.log("录音失败:"+e),n("录音失败:"+e)}))}))}createToast(e,t){var n=this;if(this.ToastDiv)this.ToastDiv.style.height="30px",this.ToastDiv.innerHTML=e;else{var o=document.createElement("div");o.id="FChatToast",o.style.cssText=`\n            width:100%;\n            line-height:30px;\n            background:rgba(0,0,0,.5);\n            position:fixed;\n            left:0;\n            font-size:16px;\n            text-indent:10px;\n            color:#fff; \n            transition:.5s linear all;\n            z-index:10;\n            overflow:hidden;\n            height:0px;\n            top:${document.getElementById("onlineHeader").clientHeight}px;\n         `,o.innerHTML=e,document.body.appendChild(o),this.ToastDiv=o,setTimeout((function(){n.ToastDiv.style.height="30px"}),100)}setTimeout((function(){n.ToastDiv.style.height="0px"}),t||3e3)}}var g=new p([]),h={name:"pops",props:{pos:{type:String,default:"right"},size:{type:Number,default:15},bg:{type:String,default:"#6AEA9E"},leftSrc:{type:String,default:n("a9d8")},rightSrc:{type:String,default:n("daf2")},type:{type:String,default:"message",validator:e=>{let t=["message","image","video","audio"].filter(t=>t==e?t:"");if(!t.join(""))throw new Error("请传入正确类型");return t.join("")}},content:{type:String},duration:{}},data(){return{imgLoadingComplete:!1}},methods:{imgLoad(){this.imgLoadingComplete=!0,setTimeout(()=>{g.scrollMessage()},0)},play(e,t){g.playVoice(e,t)}},computed:{PopProp(){let{size:e,bg:t}=this,n={fontSize:e+"px"};return t&&"#6AEA9E"!==t&&(n["background"]=t),{style:n}},className(){let{pos:e}=this;return"content-pops-"+e}},mounted(){this.$nextTick(()=>{let e=document.getElementById("PopsVideo");e&&e.addEventListener("canplaythrough",(function(){console.log("视频加载完毕"),g.scrollMessage()}))})}},f=h;function m(e,t,n,o,i,s,r,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=n,l._compiled=!0),o&&(l.functional=!0),s&&(l._scopeId="data-v-"+s),r?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},l._ssrRegister=c):i&&(c=a?function(){i.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(e,t){return c.call(t),d(e,t)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,c):[c]}return{exports:e,options:l}}var v=m(f,c,l,!1,null,null,null),y=v.exports,w={data(){return{messageString:"",controlFocus:!0,loadingHeight:0}},props:{username:{type:String,default:"暂无联系人"},contentHeight:{type:Number},contentBg:{type:String,default:"#F5F5F5"},preventId:{default:"fonlineconsultation"},leftIcon:{type:String,default:"FiconFont icon-weixinyuyin"},leftIconChange:{type:String,default:"FiconFont icon-weixinjianpan"},rightIconLeft:{type:String,default:"FiconFont icon-picture"},rightIconRight:{type:String,default:"FiconFont icon-fasong"},leftIconSize:{type:Number,default:23},rightIconSize:{type:Number,default:20},leftIconColor:{type:String,default:"#000"},rightIconColor:{type:String,default:"#000"},popBg:{type:String},popSize:{type:Number},popLeftAva:{type:String},popRightAva:{type:String}},computed:{contentProp(){let{contentHeight:e,authorHeight:t,contentBg:n}=this,o={};return o["style"]="height:"+(e||window.innerHeight-t)+"px;background:"+n||!1,o}},methods:{changContentHeight(e){new Promise(t=>{this.$refs.onlineContentAll.style.height=this.contentHeight||e-((this.$refs.onlineHeader.offsetHeight||0)+(this.$refs.onlineInput.offsetHeight||0))+"px",this.loadingHeight=e+"px",t()}).then(()=>{this.scrollAll()}).catch(e=>{throw new Error(e)})},scrollAll(){window.scrollTo(0,0),g.scrollMessage()},controlHeight(e){"blur"===e&&(this.controlScroll(document.body,!0),this.controlFocus=!0),this.controlFocus&&(setTimeout(()=>{this.changContentHeight(window.innerHeight),this.innerHeight=window.innerHeight},450),"focus"===e&&(this.controlScroll(document.body,!1),this.controlFocus=!1))},initInput(){this.messageString="",this.controlRows=1},scroll(e){e.preventDefault()},controlScroll(e,t){t?e.removeEventListener("touchmove",this.scroll):e.addEventListener("touchmove",this.scroll,{passive:!1})},controlRow(){let e=this.$refs.msgInput,t=/[\u4e00-\u9fa5]/,n=e.value.split(""),o=0,i=e.cols;n.forEach(e=>{t.test(e)?o+=2:o+=1,e.indexOf("\n")}),this.controlRows<3&&0!=o&&(this.controlRows=Math.ceil(o/i)),this.controlRows>=3&&o&&(this.controlRows=Math.ceil(o/i)>3?3:Math.ceil(o/i)),0==o&&(this.controlRows=1)},leftHandlerClick(){g.isOpenVoice?this.isVoice=!this.isVoice:g.createToast("您未开启音频加载，无法使用音频")},rightHandlerClick(){this.$emit("sendImg",g.addImage())},messageHandler(){let e=document.getElementById("msgInput");e&&(g.getLoading()||this.$emit("send",g.addMessage(e.value)))},startVoice(e){var t=this;clearTimeout(this.touchTimer),document.getElementById(this.preventId).className="fonlineconsultation-outer-div noSelect",t.controlScroll(document.body,!1),this.isCancel=!1,this.touchTimer=0,t.voiceStartLoading=!0,this.touchTimer=setTimeout((function(){g.startVoice().then((function(){t.voiceStartLoading=!1,t.voiceContent="正在录音....",t.voiceMsg="松开结束",t.startVoiceBoolean=!0})).catch((function(e){g.createToast(e),t.endInit()}))}),300),this.voiceStartX=e["touches"]["0"]["pageX"],this.voiceStartY=e["touches"]["0"]["pageY"]},moveVoice(e){clearTimeout(this.touchTimer);var t=e["touches"]["0"]["pageX"],n=e["touches"]["0"]["pageY"],o=t-this.voiceStartX,i=n-this.voiceStartY;function s(e,t){0!=this.touchTimer&&(this.voiceContent=e,this.isCancel=t)}Math.abs(i)>Math.abs(o)+50&&i<0?s.call(this,"上滑取消录音",!0):s.call(this,"正在录音....",!1)},endInit(){var e=this;clearTimeout(this.touchTimer),setTimeout((function(){e.startVoiceBoolean=!1,e.voiceMsg="开始录音",e.controlScroll(document.body,!0),document.getElementById(e.preventId).className="fonlineconsultation-outer-div",e.touchTimer=0,e.voiceStartLoading=!1}),0)},endVoice(){var e=this;e.endInit(),e.isCancel?(e.$RecordApp.Stop(),console.log("取消录音")):(g.loading(),setTimeout((function(){g.pauseVoice().then((function(t){e.endInit(),g.cancelLoading(),e.$emit("sendVoice",t)})).catch((function(t){g.cancelLoading(),g.createToast(t),e.endInit()}))}),500))}},mounted(){this.$nextTick(()=>{this.authorHeight=(this.$refs.onlineHeader.offsetHeight||0)+(this.$refs.onlineInput.offsetHeight||0),this.loadingHeight=window.innerHeight+"px"}),window.addEventListener("keydown",e=>{let{keyCode:t}=e;13===t&&this.messageHandler()}),window.addEventListener("resize",()=>{this.changContentHeight(window.innerHeight)})},watch:{controlRows(e){setTimeout(()=>{this.changContentHeight(this.innerHeight)},0)}}};const S={pops:y};var A={name:"FonlineConsultation",mixins:[w],components:S,props:{height:{default:window.innerHeight}},data(){return{MessageArrays:g.getMessage(),authorHeight:0,loading:!0,controlRows:1,innerHeight:0,isVoice:!1,voiceMsg:"按住说话",touchTimer:null,voiceContent:"正在录音....",voiceStartX:0,voiceStartY:0,isCancel:!1,startVoiceBoolean:!1,voiceStartLoading:!1}},computed:{Height(){let{fheight:e,headerHeight:t}=this;return{}},MessageArray(){return this.MessageArrays},isIOS(){return-1!=navigator.userAgent.indexOf("iPhone")}},created(){}},x=A,C=m(x,r,a,!1,null,null,null),b=C.exports;y.install=function(e){e.component(y.name,y)},b.install=function(e){e.component(b.name,b)};const I=[b,y],H=function(e){H.installted||(I.map(t=>e.component(t.name,t)),e.prototype.$FChat=g)};"undefined"!==typeof window&&window.Vue&&H(window.Vue);var j={install:H,fonlineconsultation:b,pops:y,FChat:g};t["default"]=j}})}));
//# sourceMappingURL=fonlineconsultation.umd.min.js.map